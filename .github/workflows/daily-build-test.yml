name: Daily build test
on:
  workflow_dispatch:
  push:
    branches:
      - 'develop'
      - 'pwn-9468-localise' # remove later
  # schedule:
  #   - cron: "0 0 * * 1-5" # At 00:00 on every day-of-week from Monday through Friday.

concurrency:
  group: daily-build
  cancel-in-progress: true

jobs:
  # update-daily-test-build-from-develop:
  #   uses: ./.github/workflows/build-test.yml
  #   with:
  #     with_high_priority: false
  #     move_to_rft: false
  #     lane: "daily_test"
  #     branch: "develop"
  #   secrets: inherit
  add_new_keys_to_lokalise:
    runs-on: ubuntu-latest
    env:
      SCRIPT_DIR: "Scripts/swiftgen-and-send-key-to-lokalise.sh"
      TAG_NAME: "lokalise/synced"
    steps:
      - name: Check out code
        uses: actions/checkout@v3

      - name: Fetch tag lokalise
        shell: bash
        run: |
          git fetch origin refs/tags/${{ env.XCODE_VERSION }}

      - name: Run script and sync with Lokalise
        env:
          LOKALISE_API_TOKEN: ${{ secrets.LOKALISE_API_TOKEN }}
          LOKALISE_PROJECT_ID: ${{ secrets.LOKALISE_PROJECT_ID }}
        run: |
          chmod u+x ${{ env.SCRIPT_DIR }} && ${{ env.SCRIPT_DIR }}